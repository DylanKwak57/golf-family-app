{
  "name": "Golf - Bay Number Input",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "golf-bay",
        "options": {
          "responseMode": "responseNode"
        }
      },
      "id": "a5281df5-39c9-4a0c-9c27-258961ec0e09",
      "name": "Webhook: íƒ€ì„ ì…ë ¥",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -112,
        300
      ],
      "webhookId": "golf-bay",
      "notes": "MVPì—ì„œ íƒ€ì„ ë²ˆí˜¸ ì…ë ¥ ì‹œ íŠ¸ë¦¬ê±°\n\nURL: https://dylan-automation.app.n8n.cloud/webhook/golf-bay\n\nBody:\n- pageId: ë…¸ì…˜ í˜ì´ì§€ ID\n- bayNumber: íƒ€ì„ ë²ˆí˜¸ (ì˜ˆ: 62-65)"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "update",
        "pageId": {
          "__rl": true,
          "value": "={{ $json.body.pageId }}",
          "mode": "id"
        },
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "íƒ€ì„ ë²ˆí˜¸|rich_text",
              "textContent": "={{ $json.body.bayNumber }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        112,
        300
      ],
      "id": "e3f58b33-05d3-4fb6-af54-ec6370bea075",
      "name": "Notion: íƒ€ì„ ë²ˆí˜¸ ì €ì¥",
      "credentials": {
        "notionApi": {
          "id": "AU29qZb94H2pm2jL",
          "name": "Notion account"
        }
      },
      "notes": "Bay Number í•„ë“œ ì—…ë°ì´íŠ¸"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "get",
        "pageId": {
          "__rl": true,
          "value": "={{ $json.body.pageId }}",
          "mode": "id"
        },
        "simple": false
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        320,
        300
      ],
      "id": "64d26bb8-ce67-40a1-b003-25ad1132731a",
      "name": "Notion: ë ˆìŠ¨ ì •ë³´ ì¡°íšŒ",
      "credentials": {
        "notionApi": {
          "id": "AU29qZb94H2pm2jL",
          "name": "Notion account"
        }
      },
      "notes": "ì—…ë°ì´íŠ¸ëœ ë ˆìŠ¨ í˜ì´ì§€ ì •ë³´ ì¡°íšŒ\n(ë‚ ì§œ, ì¥ì†Œ ë“± ì•Œë¦¼ ë©”ì‹œì§€ìš©)"
    },
    {
      "parameters": {
        "jsCode": "// ë ˆìŠ¨ ë°ì´í„° ê°€ê³µ\nconst lesson = $input.first().json;\nconst props = lesson.properties;\n\n// íƒ€ì„ ë²ˆí˜¸ (ë°©ê¸ˆ ì €ì¥í•œ ê°’)\nconst bayNumber = props['íƒ€ì„ ë²ˆí˜¸']?.rich_text?.[0]?.plain_text || '';\n\n// ë‚ ì§œ íŒŒì‹±\nconst lessonDateStr = props['ìˆ˜ì—… ë‚ ì§œ']?.date?.start || '';\nconst lessonDate = new Date(lessonDateStr);\n\n// í•œêµ­ì–´ ìš”ì¼\nconst koDays = ['ì¼ìš”ì¼', 'ì›”ìš”ì¼', 'í™”ìš”ì¼', 'ìˆ˜ìš”ì¼', 'ëª©ìš”ì¼', 'ê¸ˆìš”ì¼', 'í† ìš”ì¼'];\nconst dayOfWeekKo = koDays[lessonDate.getDay()];\n\n// íƒœêµ­ì–´ ìš”ì¼\nconst thDays = ['à¸§à¸±à¸™à¸­à¸²à¸—à¸´à¸•à¸¢à¹Œ', 'à¸§à¸±à¸™à¸ˆà¸±à¸™à¸—à¸£à¹Œ', 'à¸§à¸±à¸™à¸­à¸±à¸‡à¸„à¸²à¸£', 'à¸§à¸±à¸™à¸à¸¸à¸˜', 'à¸§à¸±à¸™à¸à¸¤à¸«à¸±à¸ªà¸šà¸”à¸µ', 'à¸§à¸±à¸™à¸¨à¸¸à¸à¸£à¹Œ', 'à¸§à¸±à¸™à¹€à¸ªà¸²à¸£à¹Œ'];\nconst dayOfWeekTh = thDays[lessonDate.getDay()];\n\n// ë‚ ì§œ í¬ë§·\nconst formattedDateKo = `${lessonDate.getFullYear()}-${String(lessonDate.getMonth() + 1).padStart(2, '0')}-${String(lessonDate.getDate()).padStart(2, '0')}`;\nconst formattedDateTh = `${String(lessonDate.getDate()).padStart(2, '0')}/${String(lessonDate.getMonth() + 1).padStart(2, '0')}/${lessonDate.getFullYear()}`;\n\n// ì¥ì†Œ\nconst locationKo = props['ìˆ˜ì—… ì¥ì†Œ']?.select?.name || 'í¬íƒˆë¼ì´';\nconst locationTh = locationKo === 'í¬íƒˆë¼ì´' ? 'à¹‚à¸›à¸£à¸—à¸²à¸¥à¸±à¸¢' : locationKo;\n\nreturn {\n  pageId: lesson.id,\n  bayNumber: bayNumber,\n  lessonDate: lessonDateStr,\n  formattedDateKo: formattedDateKo,\n  formattedDateTh: formattedDateTh,\n  dayOfWeekKo: dayOfWeekKo,\n  dayOfWeekTh: dayOfWeekTh,\n  locationKo: locationKo,\n  locationTh: locationTh\n};"
      },
      "id": "02c2b696-d632-4d16-9dbc-a710ff11ca73",
      "name": "Code: ì•Œë¦¼ ë°ì´í„° ê°€ê³µ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        528,
        300
      ],
      "notes": "ê°€ì¡±ê·¸ë£¹ ì•Œë¦¼ìš© ë°ì´í„° ê°€ê³µ\n- í•œêµ­ì–´/íƒœêµ­ì–´ ìš”ì¼\n- ë‚ ì§œ í¬ë§·\n- ì¥ì†Œ ë²ˆì—­"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/push",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ {\n  \"to\": \"U2168511c9cf9d66bb6cb0043f818bb1c\",\n  \"messages\": [\n    {\n      \"type\": \"text\",\n      \"text\": \"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\nğŸ¯ íƒ€ì„ ë²ˆí˜¸ ë“±ë¡ì™„ë£Œ\\n\\nğŸ“… \" + $json.dayOfWeekKo + \" (\" + $json.formattedDateKo + \")\\nğŸ“ \" + $json.locationKo + \"\\nğŸ¯ Bay: \" + $json.bayNumber + \"ë²ˆ\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\nğŸ¯ à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸«à¸¡à¸²à¸¢à¹€à¸¥à¸‚ Bay à¹à¸¥à¹‰à¸§\\n\\nğŸ“… \" + $json.dayOfWeekTh + \" (\" + $json.formattedDateTh + \")\\nğŸ“ \" + $json.locationTh + \"\\nğŸ¯ Bay: \" + $json.bayNumber + \"\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\"\n    }\n  ]\n} }}",
        "options": {}
      },
      "id": "512b6f63-3705-4cfc-831f-c2d88d092a9d",
      "name": "Line: ê°€ì¡±ê·¸ë£¹ ì•Œë¦¼",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        736,
        300
      ],
      "credentials": {
        "httpHeaderAuth": {
          "id": "7StkXj4Oj8ZezOd6",
          "name": "KFam-ZenQ"
        }
      },
      "notes": "ê°€ì¡±ê·¸ë£¹ì— íƒ€ì„ ë“±ë¡ ì•Œë¦¼ (í•œêµ­ì–´ + íƒœêµ­ì–´)\n\nâš ï¸ í…ŒìŠ¤íŠ¸: Dylan ID (U2168511c9cf9d66bb6cb0043f818bb1c)\nìš´ì˜: ê°€ì¡±ê·¸ë£¹ ID (C20b8ad1ae43e07dcb067f6f38349b602)"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ { \"success\": true, \"message\": \"Bay number saved and notification sent\" } }}",
        "options": {}
      },
      "id": "e5c1b32e-7e0c-4549-b062-68ac2f2cb2ef",
      "name": "Respond: ì„±ê³µ",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        944,
        300
      ],
      "notes": "MVPì— ì„±ê³µ ì‘ë‹µ ë°˜í™˜"
    }
  ],
  "connections": {
    "Webhook: íƒ€ì„ ì…ë ¥": {
      "main": [
        [
          {
            "node": "Notion: íƒ€ì„ ë²ˆí˜¸ ì €ì¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notion: íƒ€ì„ ë²ˆí˜¸ ì €ì¥": {
      "main": [
        [
          {
            "node": "Notion: ë ˆìŠ¨ ì •ë³´ ì¡°íšŒ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notion: ë ˆìŠ¨ ì •ë³´ ì¡°íšŒ": {
      "main": [
        [
          {
            "node": "Code: ì•Œë¦¼ ë°ì´í„° ê°€ê³µ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code: ì•Œë¦¼ ë°ì´í„° ê°€ê³µ": {
      "main": [
        [
          {
            "node": "Line: ê°€ì¡±ê·¸ë£¹ ì•Œë¦¼",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Line: ê°€ì¡±ê·¸ë£¹ ì•Œë¦¼": {
      "main": [
        [
          {
            "node": "Respond: ì„±ê³µ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "20298922d621602559fd122b2a5a456dd76c95af59a303f23bdb48333ec0e4fd"
  }
}
